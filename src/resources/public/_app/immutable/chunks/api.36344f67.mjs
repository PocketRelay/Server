import{w as p}from"./index.3d54f689.mjs";var l=(e=>(e.Default="Default",e.Admin="Admin",e.SuperAdmin="SuperAdmin",e))(l||{});function h(){return i({method:a.GET,route:"players/self"})}function E(e){return n({method:a.DELETE,route:"players/self",body:{password:e}})}function S(e){return i({method:a.GET,route:`players/${e}`})}function x(e){return n({method:a.DELETE,route:`players/${e}`})}async function b(e,t){return n({method:a.PUT,route:"players/self/details",body:{username:e,email:t}})}async function k(e,t){await n({method:a.PUT,route:"players/self/password",body:{current_password:e,new_password:t}})}function A(e,t){return i({method:a.GET,route:`players/${e}/data/${t}`})}function D(e,t,r){return i({method:a.PUT,route:`players/${e}/data/${t}`,body:{value:r}})}function $(e){return i({method:a.GET,route:`players/${e}/data`})}async function v(e,t,r){await n({method:a.PUT,route:`players/${e}/details`,body:{username:t,email:r}})}async function U(e,t){await n({method:a.PUT,route:`players/${e}/password`,body:{password:t}})}async function g(e,t){await n({method:a.PUT,route:`players/${e}/role`,body:{role:t}})}function G(e,t){return i({method:a.GET,route:`players?offset=${e}&count=${t}`})}const m="/api/";let u=null;const d=p(null),f="pr_token";function I(e){return e.role==l.Admin||e.role==l.SuperAdmin}function O(e,t){return t.role==l.Default?!0:e.role!=l.SuperAdmin||e.id===t.id?!1:t.role!=l.SuperAdmin}function L(e){d.set(null),u=e,localStorage.setItem(f,e)}function T(){d.set(null),u=null,localStorage.removeItem(f)}async function q(){if(!u)return!1;try{let e=await h();return d.set(e),!0}catch(e){const t=e;switch(t.status){case 500:console.error("Internal server error while attempting to load player");break;case 401:console.error("Stored token is no longer valid",t.text),T();break}return!1}}function w(){let e=localStorage.getItem(f);e!=null&&(u=e,d.set(null))}w();var a=(e=>(e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE",e))(a||{});async function y(e){const t={method:e.method},r=e.headers??{};u!==null&&(r["X-Token"]=u),e.method!="GET"&&e.body&&(r["Content-Type"]="application/json",t.body=JSON.stringify(e.body)),t.headers=r;let c;try{let o=m+e.route;c=await fetch(o,t)}catch{throw{status:-1,text:"Failed to connect"}}return c}async function n(e){const t=await y(e),r=t.status;if(Math.floor(r/100)===2)try{return await t.text()}catch(s){throw console.error("Invalid JSON response",s),{status:r,text:"Invalid server response"}}let o;try{o=await t.text()}catch(s){throw console.error("Failed to get error response text",s),{status:r,text:"Unknown error"}}throw{status:r,text:o}}async function i(e){const t=await y(e),r=t.status;if(Math.floor(r/100)===2)try{return await t.json()}catch(s){throw console.error("Invalid JSON response",s),{status:r,text:"Invalid server response"}}let o;try{o=await t.text()}catch(s){throw console.error("Failed to get error response text",s),{status:r,text:"Unknown error"}}throw{status:r,text:o}}export{a as H,l as P,n as a,O as b,T as c,S as d,U as e,g as f,G as g,x as h,I as i,$ as j,D as k,q as l,A as m,b as n,k as o,d as p,E as q,i as r,v as s,L as t};
