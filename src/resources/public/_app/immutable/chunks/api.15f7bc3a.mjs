import{w as p}from"./index.3d54f689.mjs";var i=(e=>(e.Default="Default",e.Admin="Admin",e.SuperAdmin="SuperAdmin",e))(i||{});function h(){return l({method:a.GET,route:"players/self"})}function P(e){return n({method:a.DELETE,route:"players/self",body:{password:e}})}function x(e){return l({method:a.GET,route:`players/${e}`})}function S(e){return n({method:a.DELETE,route:`players/${e}`})}async function b(e,t){return n({method:a.PUT,route:"players/self/details",body:{username:e,email:t}})}async function D(e,t){await n({method:a.PUT,route:"players/self/password",body:{current_password:e,new_password:t}})}function $(e,t){return l({method:a.GET,route:`players/${e}/data/${t}`})}function k(e,t,r){return l({method:a.PUT,route:`players/${e}/data/${t}`,body:{value:r}})}function v(e,t){return l({method:a.DELETE,route:`players/${e}/data/${t}`})}function A(e){return l({method:a.GET,route:`players/${e}/data`})}async function U(e,t,r){await n({method:a.PUT,route:`players/${e}/details`,body:{username:t,email:r}})}async function g(e,t){await n({method:a.PUT,route:`players/${e}/password`,body:{password:t}})}async function G(e,t){await n({method:a.PUT,route:`players/${e}/role`,body:{role:t}})}function I(e,t){return l({method:a.GET,route:`players?offset=${e}&count=${t}`})}const m="/api/";let u=null;const d=p(null),y="pr_token";function O(e){return e.role==i.Admin||e.role==i.SuperAdmin}function L(e,t){return t.role==i.Default?!0:t.role!=i.SuperAdmin||e.id===t.id}function q(e){d.set(null),u=e,localStorage.setItem(y,e)}function T(){d.set(null),u=null,localStorage.removeItem(y)}async function N(){if(!u)return!1;try{let e=await h();return d.set(e),!0}catch(e){const t=e;switch(t.status){case 500:console.error("Internal server error while attempting to load player");break;case 401:console.error("Stored token is no longer valid",t.text),T();break}return!1}}function w(){let e=localStorage.getItem(y);e!=null&&(u=e,d.set(null))}w();var a=(e=>(e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE",e))(a||{});async function f(e){const t={method:e.method},r=e.headers??{};u!==null&&(r["X-Token"]=u),e.method!="GET"&&e.body&&(r["Content-Type"]="application/json",t.body=JSON.stringify(e.body)),t.headers=r;let c;try{let o=m+e.route;c=await fetch(o,t)}catch{throw{status:-1,text:"Failed to connect"}}return c}async function n(e){const t=await f(e),r=t.status;if(Math.floor(r/100)===2)try{return await t.text()}catch(s){throw console.error("Invalid JSON response",s),{status:r,text:"Invalid server response"}}let o;try{o=await t.text()}catch(s){throw console.error("Failed to get error response text",s),{status:r,text:"Unknown error"}}throw{status:r,text:o}}async function l(e){const t=await f(e),r=t.status;if(Math.floor(r/100)===2)try{return await t.json()}catch(s){throw console.error("Invalid JSON response",s),{status:r,text:"Invalid server response"}}let o;try{o=await t.text()}catch(s){throw console.error("Failed to get error response text",s),{status:r,text:"Unknown error"}}throw{status:r,text:o}}export{a as H,i as P,n as a,L as b,T as c,x as d,g as e,G as f,I as g,S as h,O as i,A as j,k,N as l,v as m,$ as n,b as o,d as p,D as q,l as r,U as s,P as t,q as u};
